import{r as d,j as D}from"./index-acpie0c_.js";import{X as H,Y as U}from"./YAxis-DYZSV1c_.js";import{Y as z,aN as W,aO as Z,aP as G,aQ as A,aR as Q,u as q,aS as J,j as I,L as k,aT as ee,aU as te,aV as re,f as ae,T as B,g as ne,y as se}from"./CategoricalChart-CNhoLFA9.js";import{c as ie}from"./clsx-B-dksMZM.js";function K(a,t){var e=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(a,n).enumerable})),e.push.apply(e,r)}return e}function V(a){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?K(Object(e),!0).forEach(function(r){le(a,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(e)):K(Object(e)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(e,r))})}return a}function le(a,t,e){return(t=oe(t))in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}function oe(a){var t=de(a,"string");return typeof t=="symbol"?t:t+""}function de(a,t){if(typeof a!="object"||!a)return a;var e=a[Symbol.toPrimitive];if(e!==void 0){var r=e.call(a,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(a)}var he=["Webkit","Moz","O","ms"],ue=(a,t)=>{var e=a.replace(/(\w)/,n=>n.toUpperCase()),r=he.reduce((n,s)=>V(V({},n),{},{[s+e]:t}),{});return r[a]=t,r},ve=d.createContext(()=>{});function S(){return S=Object.assign?Object.assign.bind():function(a){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(a[r]=e[r])}return a},S.apply(null,arguments)}function _(a,t){var e=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(a,n).enumerable})),e.push.apply(e,r)}return e}function T(a){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?_(Object(e),!0).forEach(function(r){p(a,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(e)):_(Object(e)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(e,r))})}return a}function p(a,t,e){return(t=ce(t))in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}function ce(a){var t=fe(a,"string");return typeof t=="symbol"?t:t+""}function fe(a,t){if(typeof a!="object"||!a)return a;var e=a[Symbol.toPrimitive];if(e!==void 0){var r=e.call(a,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(a)}function me(a){var{x:t,y:e,width:r,height:n,stroke:s}=a,i=Math.floor(e+n/2)-1;return d.createElement(d.Fragment,null,d.createElement("rect",{x:t,y:e,width:r,height:n,fill:s,stroke:"none"}),d.createElement("line",{x1:t+1,y1:i,x2:t+r-1,y2:i,fill:"none",stroke:"#fff"}),d.createElement("line",{x1:t+1,y1:i+2,x2:t+r-1,y2:i+2,fill:"none",stroke:"#fff"}))}function ge(a){var{travellerProps:t,travellerType:e}=a;return d.isValidElement(e)?d.cloneElement(e,t):typeof e=="function"?e(t):d.createElement(me,t)}function N(a){var t,e,{otherProps:r,travellerX:n,id:s,onMouseEnter:i,onMouseLeave:l,onMouseDown:o,onTouchStart:h,onTravellerMoveKeyboard:u,onFocus:v,onBlur:c}=a,{y:g,x:f,travellerWidth:m,height:b,traveller:w,ariaLabel:x,data:y,startIndex:M,endIndex:P}=r,O=Math.max(n,f),j=T(T({},ae(r,!1)),{},{x:O,y:g,width:m,height:b}),L=x||"Min value: ".concat((t=y[M])===null||t===void 0?void 0:t.name,", Max value: ").concat((e=y[P])===null||e===void 0?void 0:e.name);return d.createElement(k,{tabIndex:0,role:"slider","aria-label":L,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:i,onMouseLeave:l,onMouseDown:o,onTouchStart:h,onKeyDown:E=>{["ArrowLeft","ArrowRight"].includes(E.key)&&(E.preventDefault(),E.stopPropagation(),u(E.key==="ArrowRight"?1:-1,s))},onFocus:v,onBlur:c,style:{cursor:"col-resize"}},d.createElement(ge,{travellerType:w,travellerProps:j}))}function $(a){var{index:t,data:e,tickFormatter:r,dataKey:n}=a,s=ne(e[t],n,t);return typeof r=="function"?r(s,t):s}function Y(a,t){for(var e=a.length,r=0,n=e-1;n-r>1;){var s=Math.floor((r+n)/2);a[s]>t?n=s:r=s}return t>=a[n]?n:r}function F(a){var{startX:t,endX:e,scaleValues:r,gap:n,data:s}=a,i=s.length-1,l=Math.min(t,e),o=Math.max(t,e),h=Y(r,l),u=Y(r,o);return{startIndex:h-h%n,endIndex:u===i?i:u-u%n}}function pe(a){var{x:t,y:e,width:r,height:n,fill:s,stroke:i}=a;return d.createElement("rect",{stroke:i,fill:s,x:t,y:e,width:r,height:n})}function xe(a){var{startIndex:t,endIndex:e,y:r,height:n,travellerWidth:s,stroke:i,tickFormatter:l,dataKey:o,data:h,startX:u,endX:v}=a,c=5,g={pointerEvents:"none",fill:i};return d.createElement(k,{className:"recharts-brush-texts"},d.createElement(B,S({textAnchor:"end",verticalAnchor:"middle",x:Math.min(u,v)-c,y:r+n/2},g),$({index:t,tickFormatter:l,dataKey:o,data:h})),d.createElement(B,S({textAnchor:"start",verticalAnchor:"middle",x:Math.max(u,v)+s+c,y:r+n/2},g),$({index:e,tickFormatter:l,dataKey:o,data:h})))}function ye(a){var{y:t,height:e,stroke:r,travellerWidth:n,startX:s,endX:i,onMouseEnter:l,onMouseLeave:o,onMouseDown:h,onTouchStart:u}=a,v=Math.min(s,i)+n,c=Math.max(Math.abs(i-s)-n,0);return d.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:l,onMouseLeave:o,onMouseDown:h,onTouchStart:u,style:{cursor:"move"},stroke:"none",fill:r,fillOpacity:.2,x:v,y:t,width:c,height:e})}function Te(a){var{x:t,y:e,width:r,height:n,data:s,children:i,padding:l}=a,o=d.Children.count(i)===1;if(!o)return null;var h=d.Children.only(i);return h?d.cloneElement(h,{x:t,y:e,width:r,height:n,margin:l,compact:!0,data:s}):null}var be=a=>{var{data:t,startIndex:e,endIndex:r,x:n,width:s,travellerWidth:i}=a;if(!t||!t.length)return{};var l=t.length,o=te().domain(re(0,l)).range([n,n+s-i]),h=o.domain().map(u=>o(u));return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:o(e),endX:o(r),scale:o,scaleValues:h}},R=a=>a.changedTouches&&!!a.changedTouches.length;class we extends d.PureComponent{constructor(t){super(t),p(this,"handleDrag",e=>{this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.state.isTravellerMoving?this.handleTravellerMove(e):this.state.isSlideMoving&&this.handleSlideDrag(e)}),p(this,"handleTouchMove",e=>{e.changedTouches!=null&&e.changedTouches.length>0&&this.handleDrag(e.changedTouches[0])}),p(this,"handleDragEnd",()=>{this.setState({isTravellerMoving:!1,isSlideMoving:!1},()=>{var{endIndex:e,onDragEnd:r,startIndex:n}=this.props;r==null||r({endIndex:e,startIndex:n})}),this.detachDragEndListener()}),p(this,"handleLeaveWrapper",()=>{(this.state.isTravellerMoving||this.state.isSlideMoving)&&(this.leaveTimer=window.setTimeout(this.handleDragEnd,this.props.leaveTimeOut))}),p(this,"handleEnterSlideOrTraveller",()=>{this.setState({isTextActive:!0})}),p(this,"handleLeaveSlideOrTraveller",()=>{this.setState({isTextActive:!1})}),p(this,"handleSlideDragStart",e=>{var r=R(e)?e.changedTouches[0]:e;this.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:r.pageX}),this.attachDragEndListener()}),p(this,"handleTravellerMoveKeyboard",(e,r)=>{var{data:n,gap:s}=this.props,{scaleValues:i,startX:l,endX:o}=this.state,h=this.state[r],u=i.indexOf(h);if(u!==-1){var v=u+e;if(!(v===-1||v>=i.length)){var c=i[v];r==="startX"&&c>=o||r==="endX"&&c<=l||this.setState({[r]:c},()=>{this.props.onChange(F({startX:this.state.startX,endX:this.state.endX,data:n,gap:s,scaleValues:i}))})}}}),this.travellerDragStartHandlers={startX:this.handleTravellerDragStart.bind(this,"startX"),endX:this.handleTravellerDragStart.bind(this,"endX")},this.state={}}static getDerivedStateFromProps(t,e){var{data:r,width:n,x:s,travellerWidth:i,startIndex:l,endIndex:o,startIndexControlledFromProps:h,endIndexControlledFromProps:u}=t;if(r!==e.prevData)return T({prevData:r,prevTravellerWidth:i,prevX:s,prevWidth:n},r&&r.length?be({data:r,width:n,x:s,travellerWidth:i,startIndex:l,endIndex:o}):{scale:null,scaleValues:null});if(e.scale&&(n!==e.prevWidth||s!==e.prevX||i!==e.prevTravellerWidth)){e.scale.range([s,s+n-i]);var v=e.scale.domain().map(c=>e.scale(c));return{prevData:r,prevTravellerWidth:i,prevX:s,prevWidth:n,startX:e.scale(t.startIndex),endX:e.scale(t.endIndex),scaleValues:v}}if(e.scale&&!e.isSlideMoving&&!e.isTravellerMoving&&!e.isTravellerFocused&&!e.isTextActive){if(h!=null&&e.prevStartIndexControlledFromProps!==h)return{startX:e.scale(h),prevStartIndexControlledFromProps:h};if(u!=null&&e.prevEndIndexControlledFromProps!==u)return{endX:e.scale(u),prevEndIndexControlledFromProps:u}}return null}componentWillUnmount(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}attachDragEndListener(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}detachDragEndListener(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}handleSlideDrag(t){var{slideMoveStartX:e,startX:r,endX:n,scaleValues:s}=this.state,{x:i,width:l,travellerWidth:o,startIndex:h,endIndex:u,onChange:v,data:c,gap:g}=this.props,f=t.pageX-e;f>0?f=Math.min(f,i+l-o-n,i+l-o-r):f<0&&(f=Math.max(f,i-r,i-n));var m=F({startX:r+f,endX:n+f,data:c,gap:g,scaleValues:s});(m.startIndex!==h||m.endIndex!==u)&&v&&v(m),this.setState({startX:r+f,endX:n+f,slideMoveStartX:t.pageX})}handleTravellerDragStart(t,e){var r=R(e)?e.changedTouches[0]:e;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:t,brushMoveStartX:r.pageX}),this.attachDragEndListener()}handleTravellerMove(t){var{brushMoveStartX:e,movingTravellerId:r,endX:n,startX:s,scaleValues:i}=this.state,l=this.state[r],{x:o,width:h,travellerWidth:u,onChange:v,gap:c,data:g}=this.props,f={startX:this.state.startX,endX:this.state.endX,data:g,gap:c,scaleValues:i},m=t.pageX-e;m>0?m=Math.min(m,o+h-u-l):m<0&&(m=Math.max(m,o-l)),f[r]=l+m;var b=F(f),{startIndex:w,endIndex:x}=b,y=()=>{var M=g.length-1;return r==="startX"&&(n>s?w%c===0:x%c===0)||n<s&&x===M||r==="endX"&&(n>s?x%c===0:w%c===0)||n>s&&x===M};this.setState({[r]:l+m,brushMoveStartX:t.pageX},()=>{v&&y()&&v(b)})}render(){var{data:t,className:e,children:r,x:n,y:s,dy:i,width:l,height:o,alwaysShowText:h,fill:u,stroke:v,startIndex:c,endIndex:g,travellerWidth:f,tickFormatter:m,dataKey:b,padding:w}=this.props,{startX:x,endX:y,isTextActive:M,isSlideMoving:P,isTravellerMoving:O,isTravellerFocused:j}=this.state;if(!t||!t.length||!I(n)||!I(s)||!I(l)||!I(o)||l<=0||o<=0)return null;var L=ie("recharts-brush",e),E=ue("userSelect","none"),X=s+(i??0);return d.createElement(k,{className:L,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:E},d.createElement(pe,{x:n,y:X,width:l,height:o,fill:u,stroke:v}),d.createElement(ee,null,d.createElement(Te,{x:n,y:X,width:l,height:o,data:t,padding:w},r)),d.createElement(ye,{y:X,height:o,stroke:v,travellerWidth:f,startX:x,endX:y,onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart}),d.createElement(N,{travellerX:x,id:"startX",otherProps:T(T({},this.props),{},{y:X}),onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers.startX,onTouchStart:this.travellerDragStartHandlers.startX,onTravellerMoveKeyboard:this.handleTravellerMoveKeyboard,onFocus:()=>{this.setState({isTravellerFocused:!0})},onBlur:()=>{this.setState({isTravellerFocused:!1})}}),d.createElement(N,{travellerX:y,id:"endX",otherProps:T(T({},this.props),{},{y:X}),onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers.endX,onTouchStart:this.travellerDragStartHandlers.endX,onTravellerMoveKeyboard:this.handleTravellerMoveKeyboard,onFocus:()=>{this.setState({isTravellerFocused:!0})},onBlur:()=>{this.setState({isTravellerFocused:!1})}}),(M||P||O||j||h)&&d.createElement(xe,{startIndex:c,endIndex:g,y:X,height:o,travellerWidth:f,stroke:v,tickFormatter:m,dataKey:b,data:t,startX:x,endX:y}))}}function Me(a){var t=z(),e=Z(),{startIndex:r,endIndex:n}=G(),s=d.useContext(ve),i=a.onChange,{startIndex:l,endIndex:o}=a;d.useEffect(()=>{t(A({startIndex:l,endIndex:o}))},[t,o,l]),Q();var h=d.useCallback(f=>{(f.startIndex!==r||f.endIndex!==n)&&(s==null||s(f),i==null||i(f),t(A(f)))},[i,s,t,r,n]),{x:u,y:v,width:c}=q(J),g={data:e,x:u,y:v,width:c,startIndex:r,endIndex:n,onChange:h};return d.createElement(we,S({},a,g,{startIndexControlledFromProps:l??void 0,endIndexControlledFromProps:o??void 0}))}function Ee(a){var t=z();return d.useEffect(()=>(t(W(a)),()=>{t(W(null))}),[t,a]),null}let C=class extends d.PureComponent{render(){return d.createElement(d.Fragment,null,d.createElement(Ee,{height:this.props.height,x:this.props.x,y:this.props.y,width:this.props.width,padding:this.props.padding}),d.createElement(Me,this.props))}};p(C,"displayName","Brush");p(C,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});function Oe({refAreaLeft:a,refAreaRight:t,initialData:e,setState:r}){if(a===t||!t){r(l=>({...l,refAreaLeft:"",refAreaRight:""}));return}const n=e.findIndex(l=>l.name===a),s=e.findIndex(l=>l.name===t)+1,i=e.slice(Math.min(n,s-1),Math.max(n,s));r(l=>({...l,data:i,refAreaLeft:"",refAreaRight:""}))}function je({initialData:a,setState:t}){t(e=>({...e,data:a,refAreaLeft:"",refAreaRight:""}))}function Le(a,t="var(--color-base-content)",e=12){return D.jsx(U,{tick:{fill:t,fontSize:e},...a})}function Fe(a,t="var(--color-base-content)",e=12){return D.jsx(H,{tick:{fill:t,fontSize:e},...a})}function ke(a){return D.jsx(se,{labelStyle:{color:"var(--color-base-content)",marginBottom:"4px"},contentStyle:{backgroundColor:"var(--color-base-100)",border:"none",borderRadius:"4px",padding:"8px",fontWeight:"bold"},...a})}function Ce(a){return D.jsx(C,{height:20,travellerWidth:10,stroke:"var(--color-primary)",...a})}export{Ce as B,ke as T,Fe as X,Le as Y,Oe as a,je as h};
